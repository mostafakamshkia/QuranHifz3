<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ÙˆØ±Ø¯Ø¯</title>

  <!-- Ø®Ø·ÙˆØ· Ø¹Ø±Ø¨ÙŠØ© -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">

  <style>
    :root {
      --space-dark: #0f172a;
      --space-light: #1e293b;
      --text-light: #e2e8f0;
      --text-muted: #94a3b8;
      --accent-glow: #facc15; /* Ø£ØµÙØ± Ù†Ø¬Ù…ÙŠ */
      --boy-glow: #38bdf8;    /* Ø£Ø²Ø±Ù‚ ÙØ¶Ø§Ø¦ÙŠ */
      --girl-glow: #f472b6;   /* ÙˆØ±Ø¯ÙŠ Ù…Ø¬Ø±Ù‘ÙŠ */
      --primary-glow: #a78bfa; /* Ø¨Ù†ÙØ³Ø¬ÙŠ ÙƒÙˆÙ†ÙŠ */
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    @keyframes stars-twinkle {
      0% { background-position: 0 0; }
      100% { background-position: -10000px 5000px; }
    }

    body {
      font-family: "Tajawal", system-ui, sans-serif;
      background-color: var(--space-dark);
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Cg fill='%231e293b' fill-opacity='0.4'%3E%3Ccircle cx='50' cy='50' r='1'/%3E%3Ccircle cx='10' cy='10' r='1'/%3E%3Ccircle cx='90' cy='90' r='1'/%3E%3Ccircle cx='10' cy='90' r='1'/%3E%3Ccircle cx='90' cy='10' r='1'/%3E%3Ccircle cx='30' cy='70' r='1'/%3E%3Ccircle cx='70' cy='30' r='1'/%3E%3C/g%3E%3C/svg%3E");
      animation: stars-twinkle 200s linear infinite;
      color: var(--text-light);
      line-height: 1.6;
    }

    .container {
      width: min(1200px, 92vw);
      margin: 0 auto;
      padding: 32px 0 80px;
    }

    .main-header {
      text-align: center;
      margin-bottom: 40px;
    }
    .main-header h1 {
      font-size: 42px;
      font-weight: 800;
      background: linear-gradient(90deg, var(--boy-glow), var(--girl-glow), var(--accent-glow));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 8px;
    }
    .main-header p {
      font-size: 18px;
      color: var(--text-muted);
    }

    .mission-control {
      background-color: var(--space-light);
      border: 1px solid #334155;
      border-radius: 24px;
      padding: 24px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin-bottom: 32px;
    }
    .control-panel h2 {
      font-size: 22px;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .control-panel h2 .icon {
        font-size: 24px;
    }

    .selector-grid {
      display: grid;
      gap: 16px;
    }

    .knight-card, .juz-card {
        background: var(--space-dark);
        border: 1px solid #475569;
        border-radius: 16px;
        padding: 16px;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
        display: flex;
        align-items: center;
        gap: 16px;
    }
    .knight-card:hover, .juz-card:hover {
        transform: translateY(-4px);
        border-color: var(--accent-glow);
    }
    
    .knight-card.boy.active { border-color: var(--boy-glow); box-shadow: 0 0 15px var(--boy-glow); }
    .knight-card.girl.active { border-color: var(--girl-glow); box-shadow: 0 0 15px var(--girl-glow); }
    .juz-card.amma.active { border-color: #2dd4bf; box-shadow: 0 0 15px #2dd4bf; }
    .juz-card.tabarak.active { border-color: #fb923c; box-shadow: 0 0 15px #fb923c; }

    .knight-icon { font-size: 40px; }
    .juz-icon {
        width: 48px;
        height: 48px;
        border-radius: 50%;
        display: grid;
        place-items: center;
        color: #fff;
        font-weight: 700;
    }
    .juz-icon.amma { background: linear-gradient(135deg, #2dd4bf, #0d9488); }
    .juz-icon.tabarak { background: linear-gradient(135deg, #fb923c, #f97316); }

    .card-text b { display: block; font-size: 18px; color: var(--text-light); }
    .card-text small { color: var(--text-muted); }
    
    .surah-map {
      background-color: var(--space-light);
      border: 1px solid #334155;
      border-radius: 24px;
      padding: 24px;
    }
    .surah-map-header { text-align: center; margin-bottom: 24px; }
    .surah-map-header h2 { font-size: 24px; margin-bottom: 4px; }
    .surah-map-header p { color: var(--text-muted); }

    .surah-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 16px;
    }
    .surah-tile {
        background: var(--space-dark);
        border: 1px solid #475569;
        border-radius: 16px;
        padding: 12px;
        text-decoration: none;
        color: var(--text-light);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        text-align: center;
        cursor: pointer;
    }
    .surah-tile:hover {
        transform: translateY(-4px);
        box-shadow: 0 0 15px var(--primary-glow);
    }
    .surah-tile .num {
      font-size: 28px;
      font-weight: 800;
      color: var(--accent-glow);
      line-height: 1;
    }
    .surah-tile .name { font-size: 16px; font-weight: 700; }

    @media (max-width: 800px) {
        .mission-control { grid-template-columns: 1fr; }
    }
    
    /* Toast */
    .toast {
      position:fixed; bottom:20px; right:20px; left:20px; margin:auto; width:fit-content; max-width:90vw;
      background: linear-gradient(135deg, var(--primary-glow), var(--boy-glow));
      color:#fff; padding:12px 18px; border-radius:12px; opacity:0; transform: translateY(10px);
      transition: all .3s ease; pointer-events:none; z-index:99;
      font-weight: 700;
      box-shadow: 0 5px 20px rgba(0,0,0,0.4);
    }
    .toast.show{ opacity:1; transform: translateY(0); }
  </style>
</head>
<body>

  <div class="container">
    <header class="main-header">
      <h1>ÙˆØ±Ø¯Ø¯ ğŸ“–</h1>
      <p>Ø§Ø®ØªØ± Ø±ÙÙŠÙ‚ Ø±Ø­Ù„ØªÙƒØŒ Ø­Ø¯Ø¯ ÙˆÙØ±Ø¯ÙƒØŒ ÙˆØ§Ø¨Ø¯Ø£ Ø±Ø­Ù„Ø© Ø§Ù„Ù†ÙˆØ± Ù…Ø¹ Ø§Ù„Ù‚Ø±Ø¢Ù†</p>
    </header>

    <!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… -->
    <div class="mission-control">
      <!-- Ø§Ø®ØªÙŠØ§Ø± Ø±ÙÙŠÙ‚ Ø§Ù„Ø±Ø­Ù„Ø© -->
      <div class="control-panel">
        <h2><span class="icon">ğŸ›¡ï¸</span> 1. Ø§Ø®ØªØ± Ø±ÙÙŠÙ‚ Ø±Ø­Ù„ØªÙƒ</h2>
        <div class="selector-grid">
          <div class="knight-card boy" id="genderBoy" tabindex="0" role="button" aria-pressed="false">
            <span class="knight-icon">ğŸ‘¦ğŸ»</span>
            <div class="card-text">
              <b>ÙØ§Ø±Ø³</b>
              <small>Ù„Ù„Ø¨Ø·Ù„ Ø§Ù„ØµØºÙŠØ±</small>
            </div>
          </div>
          <div class="knight-card girl" id="genderGirl" tabindex="0" role="button" aria-pressed="false">
            <span class="knight-icon">ğŸ‘§ğŸ»</span>
            <div class="card-text">
              <b>ÙØ§Ø±Ø³Ø©</b>
              <small>Ù„Ù„Ø¨Ø·Ù„Ø© Ø§Ù„ØµØºÙŠØ±Ø©</small>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¬Ø²Ø¡ -->
      <div class="control-panel">
        <h2><span class="icon">ğŸ“–</span> 2. Ø­Ø¯Ø¯ Ø§Ù„Ø¬Ø²Ø¡</h2>
        <div class="selector-grid">
          <div class="juz-card amma" id="juz30" tabindex="0" role="button" aria-pressed="false">
            <div class="juz-icon amma">30</div>
            <div class="card-text">
              <b>Ø¬Ø²Ø¡ Ø¹Ù…Ù‘</b>
              <small>Ù…Ù† Ø³ÙˆØ±Ø© Ø§Ù„Ù†Ø¨Ø£ Ø¥Ù„Ù‰ Ø§Ù„Ù†Ø§Ø³</small>
            </div>
          </div>
          <div class="juz-card tabarak" id="juz29" tabindex="0" role="button" aria-pressed="false">
            <div class="juz-icon tabarak">29</div>
            <div class="card-text">
              <b>Ø¬Ø²Ø¡ ØªØ¨Ø§Ø±Ùƒ</b>
              <small>Ù…Ù† Ø³ÙˆØ±Ø© Ø§Ù„Ù…Ù„Ùƒ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø±Ø³Ù„Ø§Øª</small>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø³ÙˆØ± -->
    <div class="surah-map" id="surahMapSection">
      <div class="surah-map-header">
        <h2 id="surahInfoTitle">ğŸ—ºï¸ Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø³ÙˆØ±</h2>
        <p id="surahInfoSubtitle">Ø§Ø®ØªØ± Ø¬Ø²Ø¡Ù‹Ø§ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø³ÙˆØ± Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù‡</p>
      </div>
      <div class="surah-grid" id="surahGrid">
        <!-- Ø§Ù„Ø³ÙˆØ± Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
      </div>
    </div>
  </div>

  <div id="toast" class="toast" role="status"></div>

  <script>
    // â€”â€” Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø­Ù„Ø©: Ø§Ù„Ø³ÙˆØ± Ù„ÙƒÙ„ Ø¬Ø²Ø¡ â€”â€”
    const JUZ_30 = [{num:78,name:'Ø§Ù„Ù†Ø¨Ø£'},{num:79,name:'Ø§Ù„Ù†Ø§Ø²Ø¹Ø§Øª'},{num:80,name:'Ø¹Ø¨Ø³'},{num:81,name:'Ø§Ù„ØªÙƒÙˆÙŠØ±'},{num:82,name:'Ø§Ù„Ø§Ù†ÙØ·Ø§Ø±'},{num:83,name:'Ø§Ù„Ù…Ø·ÙÙÙŠÙ†'},{num:84,name:'Ø§Ù„Ø§Ù†Ø´Ù‚Ø§Ù‚'},{num:85,name:'Ø§Ù„Ø¨Ø±ÙˆØ¬'},{num:86,name:'Ø§Ù„Ø·Ø§Ø±Ù‚'},{num:87,name:'Ø§Ù„Ø£Ø¹Ù„Ù‰'},{num:88,name:'Ø§Ù„ØºØ§Ø´ÙŠØ©'},{num:89,name:'Ø§Ù„ÙØ¬Ø±'},{num:90,name:'Ø§Ù„Ø¨Ù„Ø¯'},{num:91,name:'Ø§Ù„Ø´Ù…Ø³'},{num:92,name:'Ø§Ù„Ù„ÙŠÙ„'},{num:93,name:'Ø§Ù„Ø¶Ø­Ù‰'},{num:94,name:'Ø§Ù„Ø´Ø±Ø­'},{num:95,name:'Ø§Ù„ØªÙŠÙ†'},{num:96,name:'Ø§Ù„Ø¹Ù„Ù‚'},{num:97,name:'Ø§Ù„Ù‚Ø¯Ø±'},{num:98,name:'Ø§Ù„Ø¨ÙŠÙ†Ø©'},{num:99,name:'Ø§Ù„Ø²Ù„Ø²Ù„Ø©'},{num:100,name:'Ø§Ù„Ø¹Ø§Ø¯ÙŠØ§Øª'},{num:101,name:'Ø§Ù„Ù‚Ø§Ø±Ø¹Ø©'},{num:102,name:'Ø§Ù„ØªÙƒØ§Ø«Ø±'},{num:103,name:'Ø§Ù„Ø¹ØµØ±'},{num:104,name:'Ø§Ù„Ù‡Ù…Ø²Ø©'},{num:105,name:'Ø§Ù„ÙÙŠÙ„'},{num:106,name:'Ù‚Ø±ÙŠØ´'},{num:107,name:'Ø§Ù„Ù…Ø§Ø¹ÙˆÙ†'},{num:108,name:'Ø§Ù„ÙƒÙˆØ«Ø±'},{num:109,name:'Ø§Ù„ÙƒØ§ÙØ±ÙˆÙ†'},{num:110,name:'Ø§Ù„Ù†ØµØ±'},{num:111,name:'Ø§Ù„Ù…Ø³Ø¯'},{num:112,name:'Ø§Ù„Ø¥Ø®Ù„Ø§Øµ'},{num:113,name:'Ø§Ù„ÙÙ„Ù‚'},{num:114,name:'Ø§Ù„Ù†Ø§Ø³'}];
    const JUZ_29 = [{num:67,name:'Ø§Ù„Ù…Ù„Ùƒ'},{num:68,name:'Ø§Ù„Ù‚Ù„Ù…'},{num:69,name:'Ø§Ù„Ø­Ø§Ù‚Ø©'},{num:70,name:'Ø§Ù„Ù…Ø¹Ø§Ø±Ø¬'},{num:71,name:'Ù†ÙˆØ­'},{num:72,name:'Ø§Ù„Ø¬Ù†'},{num:73,name:'Ø§Ù„Ù…Ø²Ù…Ù„'},{num:74,name:'Ø§Ù„Ù…Ø¯Ø«Ø±'},{num:75,name:'Ø§Ù„Ù‚ÙŠØ§Ù…Ø©'},{num:76,name:'Ø§Ù„Ø¥Ù†Ø³Ø§Ù†'},{num:77,name:'Ø§Ù„Ù…Ø±Ø³Ù„Ø§Øª'}];

    // â€”â€” Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ­ÙƒÙ… â€”â€”
    const genderBoy = document.getElementById('genderBoy');
    const genderGirl = document.getElementById('genderGirl');
    const juz30 = document.getElementById('juz30');
    const juz29 = document.getElementById('juz29');
    const surahGrid = document.getElementById('surahGrid');
    const surahInfoTitle = document.getElementById('surahInfoTitle');
    const surahInfoSubtitle = document.getElementById('surahInfoSubtitle');
    const toast = document.getElementById('toast');

    // â€”â€” Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ â€”â€”
    let currentGender = localStorage.getItem('childGender') || null;
    let currentJuz = localStorage.getItem('currentJuz') ? parseInt(localStorage.getItem('currentJuz')) : null;

    // â€”â€” ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø±Ø­Ù„Ø© â€”â€” 
    function init() {
      if (currentGender) setGender(currentGender, false);
      if (currentJuz) setJuz(currentJuz, false);

      genderBoy.addEventListener('click', () => setGender('boy', true));
      genderGirl.addEventListener('click', () => setGender('girl', true));
      juz30.addEventListener('click', () => setJuz(30, true));
      juz29.addEventListener('click', () => setJuz(29, true));

      [genderBoy, genderGirl, juz30, juz29].forEach(el => {
          el.addEventListener('keypress', (e) => e.key === 'Enter' && el.click());
      });
      
      renderSurahMap();
    }

    function setGender(g, notifyUser) {
      currentGender = g;
      localStorage.setItem('childGender', g);
      genderBoy.classList.toggle('active', g === 'boy');
      genderGirl.classList.toggle('active', g === 'girl');
      genderBoy.setAttribute('aria-pressed', g === 'boy');
      genderGirl.setAttribute('aria-pressed', g === 'girl');
      if (notifyUser) notify(g === 'boy' ? 'ØªÙ… Ø§Ø®ØªÙŠØ§Ø±: ÙØ§Ø±Ø³ ğŸ›¡ï¸' : 'ØªÙ… Ø§Ø®ØªÙŠØ§Ø±: ÙØ§Ø±Ø³Ø© ğŸ›¡ï¸');
    }

    function setJuz(j, notifyUser) {
      currentJuz = j;
      localStorage.setItem('currentJuz', j);
      juz30.classList.toggle('active', j === 30);
      juz29.classList.toggle('active', j === 29);
      juz30.setAttribute('aria-pressed', j === 30);
      juz29.setAttribute('aria-pressed', j === 29);
      if (notifyUser) notify(j === 30 ? 'ØªÙ… ØªØ­Ø¯ÙŠØ¯: Ø¬Ø²Ø¡ Ø¹Ù…Ù‘ ğŸ“–' : 'ØªÙ… ØªØ­Ø¯ÙŠØ¯: Ø¬Ø²Ø¡ ØªØ¨Ø§Ø±Ùƒ ğŸ“–');
      renderSurahMap();
      
      document.getElementById('surahMapSection')?.scrollIntoView({ behavior:'smooth', block:'nearest' });
    }

    function renderSurahMap() {
      const data = currentJuz === 30 ? JUZ_30 : currentJuz === 29 ? JUZ_29 : null;
      surahGrid.innerHTML = '';
      
      if (!data) {
        surahInfoTitle.textContent = 'ğŸ—ºï¸ Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø³ÙˆØ±';
        surahInfoSubtitle.textContent = 'Ø§Ø®ØªØ± Ø¬Ø²Ø¡Ù‹Ø§ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø³ÙˆØ± Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù‡';
        return;
      }
      
      surahInfoTitle.textContent = `Ø³ÙˆØ± Ø¬Ø²Ø¡ ${currentJuz === 30 ? 'Ø¹Ù…Ù‘' : 'ØªØ¨Ø§Ø±Ùƒ'}`;
      surahInfoSubtitle.textContent = 'Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ø³ÙˆØ±Ø© Ù„Ø¨Ø¯Ø¡ Ø±Ø­Ù„ØªÙƒ';

      data.forEach(s => {
        const tile = document.createElement('a');
        tile.className = 'surah-tile';
        tile.setAttribute('role', 'button');
        tile.tabIndex = 0;
        tile.innerHTML = `<div class="num">${s.num}</div><div class="name">${s.name}</div>`;
        
        const launchSurahPage = () => {
            if (!currentGender) {
                notify('Ø§Ø®ØªØ± Ø±ÙÙŠÙ‚ Ø±Ø­Ù„ØªÙƒ Ø£ÙˆÙ„Ø§Ù‹!');
            } else {
                const params = new URLSearchParams({ 
                    num: s.num, 
                    name: s.name,
                    juz: currentJuz,
                    gender: currentGender 
                });
                window.location.href = `surah.html?${params.toString()}`;
            }
        };

        tile.addEventListener('click', launchSurahPage);
        tile.addEventListener('keypress', (e) => e.key === 'Enter' && launchSurahPage());


        surahGrid.appendChild(tile);
      });
    }

    function notify(msg) {
      toast.textContent = msg;
      toast.classList.add('show');
      clearTimeout(notify._t);
      notify._t = setTimeout(() => toast.classList.remove('show'), 2200);
    }
    
    init();
  </script>
</body>
</html>